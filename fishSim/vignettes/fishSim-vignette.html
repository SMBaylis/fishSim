<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Shane M Baylis" />

<meta name="date" content="2020-11-10" />

<title>fishSim-vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">fishSim-vignette</h1>
<h4 class="author">Shane M Baylis</h4>
<h4 class="date">2020-11-10</h4>



<div id="fishsim-vignette" class="section level1">
<h1>fishSim vignette</h1>
<div id="built-2020-11-10." class="section level2">
<h2>built 2020-11-10.</h2>
<p>fishSim is a package for demographic simulation and exploration of kin relationships. It includes functions to build populations and move, mate, kill, age, and switch the sex of individuals within those populations or defined subpopulations. Importantly, fishSim is individual-based and retains parentage information for all individuals, allowing full reconstruction of kin relationships to arbitrary depth.</p>
<p>In addition to population simulation features, fishSim includes a set of convenience functions allowing the user to check the scenario population growth rate, find simulation scenarios with null population growth (<code>PoNG()</code>), selectively archive subsets of the population for increased computational speed. For a given population, fishSim also includes functions to look up pairs of animals, compare their sets of ancestors, and classify them into kin categories based on their nearest shared ancestor(s), or show patterns of shared ancestors for members of a pair.</p>
<p>fishSim is developed in response to the demands of close-kin mark-recapture projects. ‘typical’ use-cases therefore involve an understanding of both demography and kin relationships. This vignette will cover two use scenarios - one relatively simple one, with:</p>
<ul>
<li>age-specific (but not sex-specific) fecundity,</li>
<li>constant adult survival,</li>
<li>a single population with no subdivisions (i.e., one ‘stock’),</li>
<li>no sex-switching, and</li>
<li>first-year survival set by <code>PoNG()</code>, giving a flat population size through time,</li>
<li>one-shot sampling of animals from the population</li>
</ul>
<p>…and a one designed to show off the bells and whistles, with:</p>
<ul>
<li>age-specific, sex-specific fecundity with within-season mating exhaustion for females,</li>
<li>age-specific, sex-specific survival,</li>
<li>three subpopulations (‘stocks’) with markovian movement between subpopulations,</li>
<li>male-to-female sex-switching,</li>
<li>a growing population,</li>
<li>lethal sampling, occurring through time during the simulation.</li>
</ul>
<p>In the ‘bells-and-whistles’ scenario, we will also cover archiving tools. For both scenarios, we will take a brief look at relationship patterns between pairs of animals.</p>
</div>
<div id="the-relatively-simple-scenario" class="section level2">
<h2>The relatively-simple scenario</h2>
<div id="setup" class="section level3">
<h3>Setup</h3>
<p>In order to simulate a population, we need an object to hold that population’s data, and the population will need some founding members. Our data object will have one line per individual, so let’s call it <code>indiv</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fishSim)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">makeFounders</span>(<span class="at">stocks =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(indiv)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                 Me Sex     Dad     Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 e089120bff044de6bf162984d9c6ae5c   M founder founder     -3     NA     1       4    NA</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 6cf669e9701345e09ef6d86347b795b7   F founder founder     -1     NA     1       2    NA</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 5b569ee7093e470c91965418974ae02d   F founder founder     -3     NA     1       4    NA</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 ebb345dfd79a4c9a879e03817479ce2b   F founder founder      0     NA     1       1    NA</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 5622a15e81e44f30ad4b4cf674811ced   M founder founder     -1     NA     1       2    NA</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 39053fcd92b549adbe2a2e9b33d5cc0d   F founder founder      0     NA     1       1    NA</span></span></code></pre></div>
<p>Now, what’s here? <code>indiv</code> has one line per individual, and each individual has an ID code (<code>indiv[,1]</code>), a sex (<code>indiv[,2]</code>), a father’s ID code (<code>indiv[,3]</code> - but which is ‘founder’ here, because founding animals can’t really be said to have parents), a mother’s ID code (<code>indiv[,4]</code> - ditto), a birth year <code>indiv[,5]</code>, a death year (<code>indiv[,6]</code> - NA for any animals that are still alive), a stock membership (<code>indiv[,7]</code>), an age in years (<code>indiv[,8]</code>), and a flag indicating whether the individual has been sampled (<code>indiv[,9]</code>).</p>
<p>The age structure, sex ratio, and stock memberships of founders can all be specified in the <code>makeFounders()</code> call. We’ve only changed one of the default values - instead of the default 3 stocks, we’re going to have a single panmictic founder population. The other defaults give us 1000 founders, with an even sex ratio, with an age-structure that implies 70% annual survival, but with a hard age-limit of 20 years.</p>
</div>
<div id="mating" class="section level3">
<h3>Mating</h3>
<p>Having set up our population, we can now get its members to breed, get older, switch sex and die, using the <code>mate()</code> (or <code>altMate()</code>), <code>birthdays()</code>, <code>sexSwitch()</code>, and <code>mort()</code> functions. If we had more than one stock, we could also get individuals to move between stocks with markovian movement probabilities, using <code>move()</code>. Let’s look at those.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(indiv)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">mate</span>(indiv, <span class="at">year =</span> <span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(indiv) <span class="do">## 200 newborns</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1200</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(indiv) <span class="do">## newborns are added to the end</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                    Me Sex                              Dad</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1195 bc90d9a25d3b476eadf35192b0aa2309   M 60b41a9d8b9d4c35840e5f4eee8a3663</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1196 4bc0267029354329afb437a73dacf92b   F abbeefab1cef40648a6921c27f60783a</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1197 2930eef08f3648d7a1c9b2b7cc2fd458   F abbeefab1cef40648a6921c27f60783a</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1198 99aecc7fdf474f3ba438abd12fe21646   F e089120bff044de6bf162984d9c6ae5c</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1199 a5cc301db9e643e4aaeb56e288d6de57   F 37566c31399f489c9b95052c7cfc047e</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1200 97b3bf05cd7949a4900ce46c45658112   F d6670249222c46f5a36750329a76b2a9</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1195 495e4facf89b48999a0a4dc8eafc57ea      1     NA     1       0    NA</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1196 e70ae54fc2e44499b5b53110e0799a8f      1     NA     1       0    NA</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1197 e70ae54fc2e44499b5b53110e0799a8f      1     NA     1       0    NA</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1198 edb59f85f394435485e66d429d75a153      1     NA     1       0    NA</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1199 ed605b39a99c47c3ac3f0bb4eb7f3daf      1     NA     1       0    NA</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1200 ba63d5e9e8fc4269a8144d21a7dcc786      1     NA     1       0    NA</span></span></code></pre></div>
<p>Here are some newborns, generated using the default <code>mate()</code> settings. Unlike founders, these newborns all have a father’s ID and a mother’s ID, are all aged 0, and all have a birth year of equal to the <code>year</code> argument. There are 200 newborns, because <code>mate()</code> generates new members as a proportion of the extant population size (i.e., we specify fecundity for the population, not the individuals), and that proportion (argument <code>fecundity</code>) is 0.2 by default. Each individual was born in a clutch, and each clutch contained a Poisson-distributed number of clutch-members, the default mean (‘batchSize’) of 0.5. <code>mate()</code> simply kept producing newborns by mating together random male/female pairs until <code>nrow(indiv) * 0.2</code> new offspring were produced.</p>
<p>Alternatively, we can mate our population using <code>altMate()</code>, which specifies individual maturities by age, and a probability distribution of number of offspring per mature female. Let’s generate some new founders and try that.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">makeFounders</span>(<span class="at">stocks =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(indiv) <span class="do">## 1000 founders</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1000</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">altMate</span>(indiv, <span class="at">firstBreed =</span> <span class="dv">2</span>, <span class="at">batchSize =</span> <span class="fl">0.9</span>, <span class="at">year =</span> <span class="dv">1</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(indiv)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                    Me Sex                              Dad</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1335 287f969983d04382950369e54f846e44   F 80efd737e9554a43bed788d00cc235a7</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1336 59eb43fa02c348b1a1986855b90c9be0   M c2684e0b3af04812a4ad82220d1a2124</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1337 930482846c1b4b3ab2de1c97a0baa421   M 3ca0fe9be93f45a3ace5899f2fd44fa1</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1338 8048ed4cc94f4c35851b99fd62e815f3   F 3ca0fe9be93f45a3ace5899f2fd44fa1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1339 9d4352248075443d9c26fd8ed183b8c0   M a25d430ddc1c4e41bcc99e7ad496d1fc</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1340 7245a66f91ca4b9bb852e8cbdb3c9040   F 03e5b45df8034c739f446c55624a770b</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1335 c80bc1c496584320939c7fe19aa2adb0      1     NA     1       0    NA</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1336 70b721705b594bf68a0597a422a19a27      1     NA     1       0    NA</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1337 e2b8c5e326ee46a3ab90635ded47cc9a      1     NA     1       0    NA</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1338 e2b8c5e326ee46a3ab90635ded47cc9a      1     NA     1       0    NA</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1339 d08b071994a64c4a938c8e9067ceee60      1     NA     1       0    NA</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1340 50a2e2a478c1484d98bd7932849b1367      1     NA     1       0    NA</span></span></code></pre></div>
<p>In this call to <code>altMate()</code>, females became sexually mature at 2 years of age (<code>firstBreed = 2</code>), and each sexually-mature female produced a Poisson-distributed number of offspring with mean set by <code>batchSize</code>. It is possible to specify age-specific or sex-specific fecundities, set paternity within-clutch to be single or multiple, to exhaust fathers within each breeding season (females, in this system, always breed to exhaustion each season), and to set a sex ratio for offspring by additional arguments to <code>altMate()</code>, and these options can also be set in <code>mate()</code>.</p>
</div>
<div id="mortality" class="section level3">
<h3>Mortality</h3>
<p>Now, let’s kill some of the population. Mortality probabilities can be flat, age-specific or stock-specific (and with a little extra effort, sex- or age:stock:sex-specific too), or we can randomly kill animals such that the population is reduced to a certain size, and we can set an age past which no animal will survive. For now, let’s set a flat 20% mortality rate (i.e., the probability of death is equal for all animals).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(indiv)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1340</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">mort</span>(indiv, <span class="at">year =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;flat&quot;</span>, <span class="at">mortRate =</span> <span class="fl">0.2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(indiv)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1340</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(indiv, <span class="at">n =</span> <span class="dv">15</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  Me Sex     Dad     Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  5a1541e54ee74e7697685d37276bd037   F founder founder     -6      1     1       7    NA</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  31eb0822de3f4fd4b2598dbe8cb20ec4   M founder founder     -1     NA     1       2    NA</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  88add15a0b8943a58933b4be9f259221   F founder founder      0     NA     1       1    NA</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  739004e58b0c439285aab0d6c9b9335b   M founder founder     -2     NA     1       3    NA</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2255668a372849afb9b10b7c7c265a9b   M founder founder      0     NA     1       1    NA</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  d885d56b90af414293295e4eb81bb963   F founder founder     -3     NA     1       4    NA</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  cd333bf6d43245669cfdc2666557f860   M founder founder     -6      1     1       7    NA</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  146e3b6ee49242e0a6d48614ae800686   F founder founder     -2      1     1       3    NA</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  c5a90a7484524051b43ff580489c9117   M founder founder      0      1     1       1    NA</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 4039c052baee40e6b7ddbef3eabd9408   M founder founder      0     NA     1       1    NA</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 39c897018342488589bd849d9f89333a   F founder founder     -2     NA     1       3    NA</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 2398dfaf676e446ab7f66b8d16565288   F founder founder      0     NA     1       1    NA</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 a40b89ffd48d4909a55b467168780112   F founder founder      0     NA     1       1    NA</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 ae6c80e0d7e64f5abac15e4a82f6e99e   F founder founder     -4     NA     1       5    NA</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 560a0d71c4d24c8492a10829a269ebcc   F founder founder     -1     NA     1       2    NA</span></span></code></pre></div>
<p>Mortality does not remove dead animals from ‘indiv’ - we will need to refer to them later - it just updates their death year to the value given in <code>year</code>. In general, though, animals with a non-NA value for death year will not move, mate, switch sex, or have birthdays.</p>
</div>
<div id="birthdays" class="section level3">
<h3>Birthdays</h3>
<p>On the topic of birthdays: that’s the final thing that must be done before we can put this all together and run a full (albeit basic) demographic simulation: we need to be able to increase the age of our animals, and that is what the <code>birthdays()</code> function is for. It’s very simple: it takes all living members of the population, and increments their age by 1.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(indiv)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                    Me Sex                              Dad</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1335 287f969983d04382950369e54f846e44   F 80efd737e9554a43bed788d00cc235a7</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1336 59eb43fa02c348b1a1986855b90c9be0   M c2684e0b3af04812a4ad82220d1a2124</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1337 930482846c1b4b3ab2de1c97a0baa421   M 3ca0fe9be93f45a3ace5899f2fd44fa1</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1338 8048ed4cc94f4c35851b99fd62e815f3   F 3ca0fe9be93f45a3ace5899f2fd44fa1</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1339 9d4352248075443d9c26fd8ed183b8c0   M a25d430ddc1c4e41bcc99e7ad496d1fc</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1340 7245a66f91ca4b9bb852e8cbdb3c9040   F 03e5b45df8034c739f446c55624a770b</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1335 c80bc1c496584320939c7fe19aa2adb0      1     NA     1       0    NA</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1336 70b721705b594bf68a0597a422a19a27      1     NA     1       0    NA</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1337 e2b8c5e326ee46a3ab90635ded47cc9a      1      1     1       0    NA</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1338 e2b8c5e326ee46a3ab90635ded47cc9a      1      1     1       0    NA</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1339 d08b071994a64c4a938c8e9067ceee60      1     NA     1       0    NA</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1340 50a2e2a478c1484d98bd7932849b1367      1     NA     1       0    NA</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">birthdays</span>(indiv)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(indiv)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                    Me Sex                              Dad</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1335 287f969983d04382950369e54f846e44   F 80efd737e9554a43bed788d00cc235a7</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1336 59eb43fa02c348b1a1986855b90c9be0   M c2684e0b3af04812a4ad82220d1a2124</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1337 930482846c1b4b3ab2de1c97a0baa421   M 3ca0fe9be93f45a3ace5899f2fd44fa1</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1338 8048ed4cc94f4c35851b99fd62e815f3   F 3ca0fe9be93f45a3ace5899f2fd44fa1</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1339 9d4352248075443d9c26fd8ed183b8c0   M a25d430ddc1c4e41bcc99e7ad496d1fc</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1340 7245a66f91ca4b9bb852e8cbdb3c9040   F 03e5b45df8034c739f446c55624a770b</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1335 c80bc1c496584320939c7fe19aa2adb0      1     NA     1       1    NA</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1336 70b721705b594bf68a0597a422a19a27      1     NA     1       1    NA</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1337 e2b8c5e326ee46a3ab90635ded47cc9a      1      1     1       0    NA</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1338 e2b8c5e326ee46a3ab90635ded47cc9a      1      1     1       0    NA</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1339 d08b071994a64c4a938c8e9067ceee60      1     NA     1       1    NA</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1340 50a2e2a478c1484d98bd7932849b1367      1     NA     1       1    NA</span></span></code></pre></div>
</div>
<div id="whats-my-population-doing-can-i-make-it-stay-the-same-size" class="section level3">
<h3>What’s my population doing? Can I make it stay the same size?</h3>
<p>A couple more functions deserve a mention here: <code>check_growthrate()</code> and <code>PoNG()</code>. <code>check_growthrate()</code> tells you how quickly your population is growing. <code>PoNG()</code> tells you what you need first-year survival to be, in order for your population to maintain a constant size (within limits - the estimation is Leslie Matrix-based, and there are ways to fool Leslie Matrices that are out of scope for this vignette but covered briefly in the <code>PoNG()</code> and <code>check_growthrate()</code> documentation). Let’s try both of those, using the mating and mortality settings we have already used.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_growthrate</span>(<span class="at">mateType =</span> <span class="st">&quot;flat&quot;</span>, <span class="at">mortType =</span> <span class="st">&quot;flat&quot;</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">batchSize =</span> <span class="fl">0.9</span>, <span class="at">firstBreed =</span> <span class="dv">2</span>, <span class="at">mortRate =</span> <span class="fl">0.2</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.01814+0i</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">## with the current settings, we expect our population to grow by about 1.8% annually.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">PoNG</span>(<span class="at">mateType =</span> <span class="st">&quot;flat&quot;</span>, <span class="at">mortType =</span> <span class="st">&quot;flat&quot;</span>, <span class="at">batchSize =</span> <span class="fl">0.9</span>, <span class="at">firstBreed =</span> <span class="dv">2</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">mortRate =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; $root
#&gt; [1] 0.305351
#&gt; 
#&gt; $f.root
#&gt; [1] 0.0001590123
#&gt; 
#&gt; $iter
#&gt; [1] 7
#&gt; 
#&gt; $init.it
#&gt; [1] NA
#&gt; 
#&gt; $estim.prec
#&gt; [1] 0.0007497369

## if first-year mortality was about 0.305, rather than 0.2, our population
## would have null growth. You can also read off a range of possible growth rates
## from the plot.</code></pre>
</div>
<div id="sampling-from-the-population" class="section level3">
<h3>Sampling from the population</h3>
<p>It is often useful to keep track of which animals in the population have been captured, and if capture is lethal, to mark captured animals as dead through a separate process from the normal ‘mort’ functions. The function <code>capture()</code> takes a sample of individuals, marks them as ‘captured’ by updating their ‘captured’ value, and, if capture is lethal, marks them as dead by updating their death year, as in <code>mort()</code>. It is possible to make <code>capture()</code> sex-specific, so that only males or only females may be captured.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## non-lethal sampling of 5 females</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">capture</span>(indiv, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">year =</span> <span class="dv">1</span>, <span class="at">fatal =</span> <span class="cn">FALSE</span>, <span class="at">sex =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">## lethal sampling of 5 animals, from either sex</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">capture</span>(indiv, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">year =</span> <span class="dv">1</span>, <span class="at">fatal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="turning-processes-into-a-simple-simulation" class="section level3">
<h3>Turning processes into a simple simulation</h3>
<p>To turn those processes into a full demographic simulation, all that is needed is to repeat the processes in a loop. Let’s do that, but set age-specific mortality so that the long-run average population growth rate is zero using the first-year mortality rate we got from <code>PoNG()</code>, so that our population is unlikely to explode or become extinct.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">makeFounders</span>(<span class="at">stocks =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ageMort <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.305</span>, <span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">100</span>)) <span class="do">## age-specific mortality is 0.305 for first-years,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.2 for all older age-classes.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>) {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">altMate</span>(indiv, <span class="at">firstBreed =</span> <span class="dv">2</span>, <span class="at">batchSize =</span> <span class="fl">0.9</span>, <span class="at">year =</span> y) <span class="do">## y for year</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">mort</span>(indiv, <span class="at">year =</span> y, <span class="at">type =</span> <span class="st">&quot;age&quot;</span>, <span class="at">ageMort =</span> ageMort)    <span class="do">## age-specific mort</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">birthdays</span>(indiv)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(indiv) <span class="do">## a population with 60 years of births, deaths, and birthdays</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                     Me Sex                              Dad</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89259 7f7b7198411e4a9c910acfa4c476f5c7   M 02b553d9f5804700925551eb6364caf7</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89260 e6200313412948f0932083f716a482bd   M 225bedcc346740ce901a5de3cc043171</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89261 da7b93cdd4074d5f9d713f14aec4c6a0   F 01927508206f4f779cb112e4b596b3cc</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89262 5699d4bdfbef4359a9911da22a209fc0   M 7facc73a2dba4d1f931526359eac44dc</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89263 2d176fd6540346df9a4990ea62338419   M 27818e2b25be4b5294c27058150d6c4a</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89264 cfe1c24073ab4753beefc80fc6c15c19   M 6f3b44d180ee4a37b8570c585e7d38a3</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                    Mum BirthY DeathY Stock AgeLast SampY</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89259 dbf80bdf209e41bab5e65dad1d600574     60     NA     1       1    NA</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89260 a012b17624b34c1ca2efe5ccaf66d49c     60     NA     1       1    NA</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89261 ba68d01c443c4293aaa32d7101c0c4c6     60     60     1       0    NA</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89262 c0a63169a42743c19986e47412edac64     60     NA     1       1    NA</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89263 a494b5ea2f9047dc9e36d005d91314ce     60     NA     1       1    NA</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89264 1d207406891149e7a93537ffa4de43a3     60     NA     1       1    NA</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(indiv[<span class="fu">is.na</span>(indiv[,<span class="dv">6</span>]),]) <span class="do">## the currently-alive population size. Note that population</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 11548</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                               <span class="do">## growth only *averages* zero, and variability occurs!</span></span></code></pre></div>
</div>
<div id="looking-up-relationships-between-pairs-of-animals" class="section level3">
<h3>Looking up relationships between pairs of animals</h3>
<p>One of the key advantages of fishSim is its ability to report on different relationships between pairs of animals in a sample. Are these two each other’s siblings? Half-siblings? Is one the parent of the other? The grandparent? Some obscure half-cousin, once removed?</p>
<p>Internally, these relationships are stored in terms of ‘shared ancestors at the n’th generation of each member’, starting with the ‘self’ as generation 1. So a pair might have a shared <code>pairs$TwoThree</code> ancestor - that ancestor is the parent of one member, and the grandparent of the other. Or the pair might have a shared <code>pairs$OneTwo</code> ancestor - in which case, one member’s <em>self</em> is the other member’s parent.</p>
<p>If a pair shares a parent (i.e., <code>pairs$TwoTwo == 1</code>), then they also share at least two grandparents (<code>pairs$ThreeThree &gt;= 2</code>), four great-grandparents (<code>pairs$FourFour &gt;= 4</code>), and so on. This pattern holds generally: a half thiatic pair (<code>pairs$TwoThree == 1</code>) will also share at least two <code>pairs$ThreeFour &gt;= 2</code> ancestors and at least four <code>pairs$FourFive &gt;= 4</code> ancestors. It is also possible, for example, for a pair to share two grandparents, but no parents - that is the case for full cousin pairs.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## mark 100 individuals alive at the end of the simulation as &#39;captured&#39;.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">capture</span>(indiv, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">year =</span> <span class="dv">60</span>, <span class="at">fatal =</span> <span class="cn">FALSE</span>) </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## look up each animal&#39;s ancestors and look for shared ancestors between each</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## pair of sampled animals:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>pairs <span class="ot">&lt;-</span> <span class="fu">findRelativesPar</span>(<span class="at">indiv =</span> indiv, <span class="at">sampled =</span> <span class="cn">TRUE</span>, <span class="at">nCores =</span> <span class="dv">2</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Sample.Year Freq</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          60  200</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;parents found at 2020-11-10 12:04:10&quot;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;grandparents found at  2020-11-10 12:04:11&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-grandparents found at 2020-11-10 12:04:14&quot;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-great-grandparents found at 2020-11-10 12:04:19&quot;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-great-great-grandparents found at 2020-11-10 12:04:29&quot;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-great-great-great-grandparents found at 2020-11-10 12:04:50&quot;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1000 of 19900 comparisons at 2020-11-10 12:04:51&quot;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2000 of 19900 comparisons at 2020-11-10 12:04:51&quot;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;3000 of 19900 comparisons at 2020-11-10 12:04:51&quot;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;4000 of 19900 comparisons at 2020-11-10 12:04:52&quot;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;5000 of 19900 comparisons at 2020-11-10 12:04:53&quot;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;6000 of 19900 comparisons at 2020-11-10 12:04:53&quot;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;7000 of 19900 comparisons at 2020-11-10 12:04:53&quot;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;8000 of 19900 comparisons at 2020-11-10 12:04:54&quot;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;9000 of 19900 comparisons at 2020-11-10 12:04:54&quot;</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;10000 of 19900 comparisons at 2020-11-10 12:04:54&quot;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;11000 of 19900 comparisons at 2020-11-10 12:04:55&quot;</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;12000 of 19900 comparisons at 2020-11-10 12:04:55&quot;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;13000 of 19900 comparisons at 2020-11-10 12:04:55&quot;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;14000 of 19900 comparisons at 2020-11-10 12:04:56&quot;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;15000 of 19900 comparisons at 2020-11-10 12:04:56&quot;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;16000 of 19900 comparisons at 2020-11-10 12:04:57&quot;</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;17000 of 19900 comparisons at 2020-11-10 12:04:57&quot;</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;18000 of 19900 comparisons at 2020-11-10 12:04:57&quot;</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;19000 of 19900 comparisons at 2020-11-10 12:04:58&quot;</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>POPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>OneTwo <span class="sc">==</span> <span class="dv">1</span>,] <span class="do">## Parent-Offspring pairs</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>GGPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>OneThree <span class="sc">==</span> <span class="dv">1</span>,] <span class="do">## Grandparent-Grandoffspring pairs</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>HSPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>TwoTwo <span class="sc">==</span> <span class="dv">1</span>,] <span class="do">## Half-sibling pairs</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>FSPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>TwoTwo <span class="sc">==</span> <span class="dv">2</span>,] <span class="do">## Full Sibling pairs (self-comparisons </span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="do">## are automatically excluded)</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>FCPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>ThreeThree <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> pairs<span class="sc">$</span>TwoTwo <span class="sc">!=</span> <span class="dv">1</span>,] <span class="do">## Full Cousin pairs</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="do">## look at the number of shared ancestors at each ancestral</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="do">## generation, for one of the half-sibling pairs.</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lookAtPair</span>(HSPs[<span class="dv">1</span>,]) </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Self Par GP G2P G3P G4P G5P</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Self    .   .  .   .   .   .   .</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Par     .   1  .   .   .   .   .</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GP      .   .  2   .   .   .   .</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G2P     .   .  .   4   .   .   .</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G3P     .   .  .   .   8   .   .</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G4P     .   .  .   .   .  16   .</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G5P     .   .  .   .   .   .  32</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>relatives <span class="ot">&lt;-</span> <span class="fu">namedRelatives</span>(pairs) <span class="do">## shows the number of pairs of each relationship type</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>relatives</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   POPs GGPs dGGPs G4Ps dG4Ps G6Ps dG6Ps HSPs FSPs HTPs FTPs HCPs FCPs GHCPs GFCPs  ORCs</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    5    0     0    3     0    3     0    6    0   19    1   15    0    12     1 13491</span></span></code></pre></div>
</div>
</div>
<div id="the-bells-and-whistles-scenario" class="section level2">
<h2>The ‘bells and whistles’ scenario</h2>
<p>In this second scenario, we will simulate a metapopulation with:</p>
<ul>
<li>age-specific, sex-specific fecundity with within-season mating exhaustion for females,</li>
<li>stock-specific, age-specific survival,</li>
<li>three subpopulations (‘stocks’) with markovian movement between subpopulations,</li>
<li>male-to-female sex-switching,</li>
<li>a growing population.</li>
<li>archiving for speed (?)</li>
</ul>
<p>We set up the population basically as before, with a couple of slight tweaks. First, we should make sure the founding population has multiple stocks (we’ll give it three). Second, we will set up an archive matrix. The archive matrix is intended to hold the records of dead animals in large, long-running simulations: dead animals do not take part in any further mating, movement, sex-switching, aging, or mortality events, but if they stay in <code>indiv</code>, <code>indiv</code> can become huge and unweildy, slowing down all of those processes. There is of course a trade-off, in that writing dead animals to the archive takes system time, so the optimum may be to only archive dead animals once every few ‘years’.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set up founders with three stocks: two that each contain 30% of the population,</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## and one that contains the remaining 40%.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">makeFounders</span>(<span class="at">pop =</span> <span class="dv">1000</span>, <span class="at">stocks =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">## set up archive - just a matrix with zero rows and eight columns</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>archive <span class="ot">&lt;-</span> <span class="fu">make_archive</span>()</span></code></pre></div>
<p>Because we will have inter-stock movement in this sim, we will also need to set up a matrix giving the probability that an individual will move into another stock, given its current stock membership. Because survival will be age- and stock-dependent, we will need a matrix of survival rates with as many columns as stocks, and as many rows as (at least) the age of the oldest plausible population-member. Because we will have age-specific, sex-specific fecundity, we will need a male age-specific maturity curve and a female age-specific maturity curve. Let’s set those up now.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Markovian movement matrix</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>admix.m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(stocks), <span class="at">ncol =</span> <span class="fu">length</span>(stocks))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(admix.m)) {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    admix.m[i,] <span class="ot">&lt;-</span> stocks<span class="sc">*</span>stocks[i]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">## admix.m shows movement proportional to starting population sizes.</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>admix.m</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.09 0.09 0.12</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.09 0.09 0.12</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.12 0.12 0.16</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="do">## let&#39;s tweak those numbers so that animals tend to stay where</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">## they are, and not move around so much.</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>admix.m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.23</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.03</span>, <span class="fl">0.23</span>, <span class="fl">0.04</span>, <span class="fl">0.04</span>, <span class="fl">0.04</span>, <span class="fl">0.32</span>),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="fu">length</span>(stocks), <span class="at">ncol =</span> <span class="fu">length</span>(stocks), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>admix.m</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.23 0.03 0.04</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.03 0.23 0.04</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.04 0.04 0.32</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Age- and stock-dependent survival</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>ageStockMort <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.47</span>, <span class="fl">0.37</span>, <span class="fl">0.27</span>, <span class="fu">rep</span>(<span class="fl">0.23</span>, <span class="dv">97</span>),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">0.45</span>, <span class="fl">0.35</span>, <span class="fl">0.25</span>, <span class="fl">0.20</span>, <span class="fu">rep</span>(<span class="fl">0.22</span>, <span class="dv">96</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0.45</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.19</span>, <span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">96</span>)),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">length</span>(stocks), <span class="at">nrow =</span> <span class="dv">100</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ageStockMort)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.47 0.45 0.45</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.37 0.35 0.30</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.27 0.25 0.30</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.23 0.20 0.19</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 0.23 0.22 0.20</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,] 0.23 0.22 0.20</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Sex-specific maturity curves</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>maleCurve <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="fl">0.85</span>,<span class="fl">0.9</span>,<span class="fl">0.95</span>,<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">91</span>))</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>femaleCurve <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>,<span class="fl">0.95</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">95</span>))</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="do">## maleCurve and femaleCurve should both be long enough that no individuals</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="do">## will outlive the curve.</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(maleCurve)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.0 0.0 0.0 0.1 0.5 0.8</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(femaleCurve)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.00 0.00 0.50 0.90 0.95 1.00</span></span></code></pre></div>
<p>Now, what’s going to happen with these subpopulations, if we run with those parameters?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_growthrate</span>(<span class="at">mateType =</span> <span class="st">&quot;ageSex&quot;</span>, <span class="at">mortType =</span> <span class="st">&quot;ageStock&quot;</span>, <span class="at">batchSize =</span> <span class="fl">1.6</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">femaleCurve =</span> femaleCurve,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ageStockMort =</span> ageStockMort)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9933195+0i 1.0148927+0i 1.0271639+0i</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Not bad. Two of the three populations are increasing. The third will probably be kept viable</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## by immigration from the other two. Note that I fiddled &#39;batchSize&#39; (which is the mean number</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="do">## of offspring per mature female per breeding attempt) a bit.</span></span></code></pre></div>
<p>Now we just run the population simulator, as we did for the simple population, but with a couple of extra things to specify. Let’s give it 60 years.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="do">## very rarely, switch some males to females</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">sexSwitch</span>(<span class="at">indiv =</span> indiv, <span class="at">direction =</span> <span class="st">&quot;MF&quot;</span>, <span class="at">prob =</span> <span class="fl">1e-04</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## move animals according to the markovian matrix we set up before</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">move</span>(<span class="at">indiv =</span> indiv, <span class="at">moveMat =</span> admix.m)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## mate animals using the age-specific, sex-specific curves we set up before</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">altMate</span>(<span class="at">indiv =</span> indiv, <span class="at">batchSize =</span> <span class="fl">1.6</span>, <span class="at">type =</span> <span class="st">&quot;ageSex&quot;</span>, <span class="at">maleCurve =</span> maleCurve,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">femaleCurve =</span> femaleCurve, <span class="at">year =</span> k)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="do">## kill animals on the basis of their age and stock, as set up before   </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">birthdays</span>(<span class="at">indiv =</span> indiv) </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">mort</span>(<span class="at">indiv =</span> indiv, <span class="at">year =</span> k, <span class="at">type =</span> <span class="st">&quot;ageStock&quot;</span>, <span class="at">ageStockMort =</span> ageStockMort)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(k <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>)) {</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        indiv <span class="ot">&lt;-</span> <span class="fu">capture</span>(indiv, <span class="at">n =</span> <span class="dv">40</span>, <span class="at">fatal =</span> <span class="cn">TRUE</span>, <span class="at">year =</span> k)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        archive <span class="ot">&lt;-</span> <span class="fu">archive_dead</span>(<span class="at">indiv =</span> indiv, <span class="at">archive =</span> archive)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        indiv <span class="ot">&lt;-</span> <span class="fu">remove_dead</span>(<span class="at">indiv =</span> indiv)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Iteration &quot;</span>, k, <span class="st">&quot; complete&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="do">## occasionally sample from the population and do some clean-up. And report on progress.</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Iteration 10 complete&quot;</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Iteration 20 complete&quot;</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Iteration 30 complete&quot;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Iteration 40 complete&quot;</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Iteration 50 complete&quot;</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Iteration 60 complete&quot;</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>archive <span class="ot">&lt;-</span> <span class="fu">rbind</span>(archive, indiv)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> archive  <span class="do">## merge &#39;indiv&#39; and &#39;archive&#39;, since they were only separated for speed.</span></span></code></pre></div>
<p>Now that the simulation is finished, examining kin relationships is the same as the simple scenario, except that we integrated capture into the simulation, so we don’t need to call <code>capture()</code> now:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## look up each animal&#39;s ancestors and look for shared ancestors between each</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## pair of sampled animals:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pairs <span class="ot">&lt;-</span> <span class="fu">findRelativesPar</span>(<span class="at">indiv =</span> indiv, <span class="at">sampled =</span> <span class="cn">TRUE</span>, <span class="at">nCores =</span> <span class="dv">2</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Sample.Year Freq</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          10   40</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          20   40</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          30   40</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4          40   40</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5          50   40</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6          60   40</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;parents found at 2020-11-10 12:05:18&quot;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;grandparents found at  2020-11-10 12:05:19&quot;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-grandparents found at 2020-11-10 12:05:21&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-great-grandparents found at 2020-11-10 12:05:25&quot;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-great-great-grandparents found at 2020-11-10 12:05:32&quot;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;great-great-great-great-grandparents found at 2020-11-10 12:05:44&quot;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1000 of 28680 comparisons at 2020-11-10 12:05:44&quot;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2000 of 28680 comparisons at 2020-11-10 12:05:44&quot;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;3000 of 28680 comparisons at 2020-11-10 12:05:45&quot;</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;4000 of 28680 comparisons at 2020-11-10 12:05:45&quot;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;5000 of 28680 comparisons at 2020-11-10 12:05:45&quot;</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;6000 of 28680 comparisons at 2020-11-10 12:05:45&quot;</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;7000 of 28680 comparisons at 2020-11-10 12:05:46&quot;</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;8000 of 28680 comparisons at 2020-11-10 12:05:46&quot;</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;9000 of 28680 comparisons at 2020-11-10 12:05:46&quot;</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;10000 of 28680 comparisons at 2020-11-10 12:05:47&quot;</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;11000 of 28680 comparisons at 2020-11-10 12:05:47&quot;</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;12000 of 28680 comparisons at 2020-11-10 12:05:47&quot;</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;13000 of 28680 comparisons at 2020-11-10 12:05:48&quot;</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;14000 of 28680 comparisons at 2020-11-10 12:05:48&quot;</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;15000 of 28680 comparisons at 2020-11-10 12:05:48&quot;</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;16000 of 28680 comparisons at 2020-11-10 12:05:48&quot;</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;17000 of 28680 comparisons at 2020-11-10 12:05:49&quot;</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;18000 of 28680 comparisons at 2020-11-10 12:05:49&quot;</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;19000 of 28680 comparisons at 2020-11-10 12:05:49&quot;</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;20000 of 28680 comparisons at 2020-11-10 12:05:50&quot;</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;21000 of 28680 comparisons at 2020-11-10 12:05:50&quot;</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;22000 of 28680 comparisons at 2020-11-10 12:05:50&quot;</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;23000 of 28680 comparisons at 2020-11-10 12:05:51&quot;</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;24000 of 28680 comparisons at 2020-11-10 12:05:51&quot;</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;25000 of 28680 comparisons at 2020-11-10 12:05:51&quot;</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;26000 of 28680 comparisons at 2020-11-10 12:05:52&quot;</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;27000 of 28680 comparisons at 2020-11-10 12:05:52&quot;</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;28000 of 28680 comparisons at 2020-11-10 12:05:52&quot;</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>POPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>OneTwo <span class="sc">==</span> <span class="dv">1</span>,] <span class="do">## Parent-Offspring pairs</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>GGPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>OneThree <span class="sc">==</span> <span class="dv">1</span>,] <span class="do">## Grandparent-Grandoffspring pairs</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>HSPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>TwoTwo <span class="sc">==</span> <span class="dv">1</span>,] <span class="do">## Half-sibling pairs</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>FSPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>TwoTwo <span class="sc">==</span> <span class="dv">2</span>,] <span class="do">## Full Sibling pairs (self-comparisons </span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="do">## are automatically excluded)</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>FCPs <span class="ot">&lt;-</span> pairs[pairs<span class="sc">$</span>ThreeThree <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> pairs<span class="sc">$</span>TwoTwo <span class="sc">!=</span> <span class="dv">1</span>,] <span class="do">## Full Cousin pairs</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="do">## look at the number of shared ancestors at each ancestral</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="do">## generation, for one of the half-sibling pairs.</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="fu">lookAtPair</span>(HSPs[<span class="dv">1</span>,]) </span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Self Par GP G2P G3P G4P G5P</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Self    .   .  .   .   .   .   .</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Par     .   1  .   .   .   .   .</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GP      .   .  4   8   8   8   8</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G2P     .   .  8   8  16  16  16</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G3P     .   .  8  16  16  32  32</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G4P     .   .  8  16  32  32  64</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; G5P     .   .  8  16  32  64  64</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>relatives <span class="ot">&lt;-</span> <span class="fu">namedRelatives</span>(pairs) <span class="do">## shows the number of pairs of each relationship type</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>relatives</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   POPs GGPs dGGPs G4Ps dG4Ps G6Ps dG6Ps HSPs FSPs HTPs FTPs HCPs FCPs GHCPs GFCPs  ORCs</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    6    1     0    9     0   15     0   16    4   60   97   53  197   102   233 25374</span></span></code></pre></div>
</div>
<div id="a-note-on-mark-dependent-survival-or-movement" class="section level2">
<h2>A note on mark-dependent survival or movement</h2>
<p>It is possible to simulate mark-dependent survival or movement by working on subsets of the ‘indiv’ matrix within the main simulation loop, and applying different mortality or movement operations to each subset. Note that this should <em>not</em> be done for <code>mate()</code> operations - if <code>mate()</code> is run on a subset of the population, mating will only occur between members of that subset. In the case of subsets for marked and unmarked individuals, this would imply that marked animals only mate with other marked animals, and <em>vice versa</em>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> <span class="fu">makeFounders</span>(<span class="at">stocks =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ageMort <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.305</span>, <span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">100</span>)) <span class="do">## age-specific mortality is 0.305 for first-years,</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.2 for all older age-classes.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">altMate</span>(indiv, <span class="at">firstBreed =</span> <span class="dv">2</span>, <span class="at">batchSize =</span> <span class="fl">0.9</span>, <span class="at">year =</span> y) <span class="do">## y for year</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">capture</span>(indiv, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">year =</span> y, <span class="at">fatal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    indiv_unmarked <span class="ot">&lt;-</span> indiv[<span class="fu">is.na</span>(indiv[,<span class="dv">9</span>]),] <span class="do">## all the unmarked animals</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    indiv_marked <span class="ot">&lt;-</span> indiv[<span class="sc">!</span><span class="fu">is.na</span>(indiv[,<span class="dv">9</span>]),]  <span class="do">## all the marked animals</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    indiv_unmarked <span class="ot">&lt;-</span> <span class="fu">mort</span>(indiv_unmarked, <span class="at">year =</span> y, <span class="at">type =</span> <span class="st">&quot;age&quot;</span>, <span class="at">ageMort =</span> ageMort) </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="do">## normal mort for unmarked animals</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    indiv_marked <span class="ot">&lt;-</span> <span class="fu">mort</span>(indiv_marked, <span class="at">year =</span> y, <span class="at">type =</span> <span class="st">&quot;age&quot;</span>, <span class="at">ageMort =</span> ageMort<span class="sc">*</span><span class="dv">2</span>)  </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="do">## double mort for marked animals</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">rbind</span>(indiv_unmarked, indiv_marked) </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="do">## stick them back together and proceed as normal</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(indiv_marked, indiv_unmarked) <span class="do">## clean up</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    indiv <span class="ot">&lt;-</span> <span class="fu">birthdays</span>(indiv)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
